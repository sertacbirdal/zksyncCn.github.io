<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>入门 | zkSync — Accelerating the mass adoption of crypto for personal sovereignty</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="/__/firebase/7.13.2/firebase-app.js" defer="true"></script>
    <script src="/__/firebase/7.13.2/firebase-analytics.js" defer="true"></script>
    <script src="/__/firebase/init.js" defer="true"></script>
    <script>
  const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://zksync.io");
      homeEl.setAttribute("onclick", "document.location='https://zksync.io';return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://zksync.io';return false;");
      clearInterval(logoUrlChanger);
    }
  }, 1000)</script>
    <meta name="description" content="zkSync is a ZK rollup that represents the end-game for scaling Ethereum - one that scales its technology and values without degrading security or decentralization">
    
    <link rel="preload" href="/assets/css/0.styles.350a0b01.css" as="style"><link rel="preload" href="/assets/js/app.3e63508a.js" as="script"><link rel="preload" href="/assets/js/2.5a73362d.js" as="script"><link rel="preload" href="/assets/js/39.9ac412c7.js" as="script"><link rel="prefetch" href="/assets/js/10.1d31b665.js"><link rel="prefetch" href="/assets/js/11.7335d221.js"><link rel="prefetch" href="/assets/js/12.4d53931c.js"><link rel="prefetch" href="/assets/js/13.e7352fdc.js"><link rel="prefetch" href="/assets/js/14.0c7cfd9a.js"><link rel="prefetch" href="/assets/js/15.a0dce9fd.js"><link rel="prefetch" href="/assets/js/16.194f569d.js"><link rel="prefetch" href="/assets/js/17.7e3694b3.js"><link rel="prefetch" href="/assets/js/18.523d436b.js"><link rel="prefetch" href="/assets/js/19.248e6c74.js"><link rel="prefetch" href="/assets/js/20.abf592a4.js"><link rel="prefetch" href="/assets/js/21.51ea3602.js"><link rel="prefetch" href="/assets/js/22.d2979550.js"><link rel="prefetch" href="/assets/js/23.402a0d23.js"><link rel="prefetch" href="/assets/js/24.6bacca56.js"><link rel="prefetch" href="/assets/js/25.afe0dc2b.js"><link rel="prefetch" href="/assets/js/26.1d5572a0.js"><link rel="prefetch" href="/assets/js/27.a115d37b.js"><link rel="prefetch" href="/assets/js/28.8dee3885.js"><link rel="prefetch" href="/assets/js/29.1a1c57dd.js"><link rel="prefetch" href="/assets/js/3.d90af0c5.js"><link rel="prefetch" href="/assets/js/30.35d5900b.js"><link rel="prefetch" href="/assets/js/31.0297b3b6.js"><link rel="prefetch" href="/assets/js/32.665572a2.js"><link rel="prefetch" href="/assets/js/33.018706b6.js"><link rel="prefetch" href="/assets/js/34.55102de6.js"><link rel="prefetch" href="/assets/js/35.2f4d0897.js"><link rel="prefetch" href="/assets/js/36.d86e7687.js"><link rel="prefetch" href="/assets/js/37.6310a1d0.js"><link rel="prefetch" href="/assets/js/38.52314fd5.js"><link rel="prefetch" href="/assets/js/4.e3758d8a.js"><link rel="prefetch" href="/assets/js/40.303d81a3.js"><link rel="prefetch" href="/assets/js/41.adf30d4f.js"><link rel="prefetch" href="/assets/js/42.0f6b442e.js"><link rel="prefetch" href="/assets/js/43.a93166b9.js"><link rel="prefetch" href="/assets/js/44.6e1a6fcc.js"><link rel="prefetch" href="/assets/js/45.a45855fc.js"><link rel="prefetch" href="/assets/js/46.c8b51949.js"><link rel="prefetch" href="/assets/js/47.2c07aaec.js"><link rel="prefetch" href="/assets/js/48.9089c32e.js"><link rel="prefetch" href="/assets/js/49.ebff2130.js"><link rel="prefetch" href="/assets/js/5.3964cc5a.js"><link rel="prefetch" href="/assets/js/50.a73de0a3.js"><link rel="prefetch" href="/assets/js/51.521cee59.js"><link rel="prefetch" href="/assets/js/52.e967177e.js"><link rel="prefetch" href="/assets/js/53.ed87d8b6.js"><link rel="prefetch" href="/assets/js/54.9d27e80f.js"><link rel="prefetch" href="/assets/js/55.9a6c2638.js"><link rel="prefetch" href="/assets/js/56.fe219180.js"><link rel="prefetch" href="/assets/js/57.5176b24b.js"><link rel="prefetch" href="/assets/js/58.5fd786a4.js"><link rel="prefetch" href="/assets/js/59.71862d4f.js"><link rel="prefetch" href="/assets/js/6.2867863c.js"><link rel="prefetch" href="/assets/js/60.e2649943.js"><link rel="prefetch" href="/assets/js/61.d6fb26b8.js"><link rel="prefetch" href="/assets/js/62.1a9541a9.js"><link rel="prefetch" href="/assets/js/63.ea0501a4.js"><link rel="prefetch" href="/assets/js/64.ebd6db8c.js"><link rel="prefetch" href="/assets/js/65.6f7f0466.js"><link rel="prefetch" href="/assets/js/66.23a37493.js"><link rel="prefetch" href="/assets/js/67.3c815a55.js"><link rel="prefetch" href="/assets/js/68.c6fed9d6.js"><link rel="prefetch" href="/assets/js/69.937986ed.js"><link rel="prefetch" href="/assets/js/7.9cb55bb9.js"><link rel="prefetch" href="/assets/js/70.25b1f05d.js"><link rel="prefetch" href="/assets/js/71.6812e6cd.js"><link rel="prefetch" href="/assets/js/72.be287cf6.js"><link rel="prefetch" href="/assets/js/73.8746812e.js"><link rel="prefetch" href="/assets/js/74.8b4800dc.js"><link rel="prefetch" href="/assets/js/75.dd3b7d87.js"><link rel="prefetch" href="/assets/js/76.1296ab08.js"><link rel="prefetch" href="/assets/js/8.f9eaafb5.js"><link rel="prefetch" href="/assets/js/9.2e9fb4a6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.350a0b01.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/LogotypeLight.svg" alt="zkSync — Accelerating the mass adoption of crypto for personal sovereignty" class="logo"> <span class="site-name can-hide">zkSync — Accelerating the mass adoption of crypto for personal sovereignty</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dev/" class="nav-link">
  开发文档
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  工具/SDK
</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="v2.0" class="dropdown-title"><span class="title">v2.0</span> <span class="arrow down"></span></button> <button type="button" aria-label="v2.0" class="mobile-dropdown-title"><span class="title">v2.0</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link">
  v2.0
</a></li><li class="dropdown-item"><!----> <a href="https://docs.zksync.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/matter-labs/zksync-web-v2-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dev/" class="nav-link">
  开发文档
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  工具/SDK
</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="v2.0" class="dropdown-title"><span class="title">v2.0</span> <span class="arrow down"></span></button> <button type="button" aria-label="v2.0" class="mobile-dropdown-title"><span class="title">v2.0</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link">
  v2.0
</a></li><li class="dropdown-item"><!----> <a href="https://docs.zksync.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/matter-labs/zksync-web-v2-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/api/" aria-current="page" class="sidebar-link">概述</a></li><li><a href="/api/api.html" class="sidebar-link">Web3 API</a></li><li><a href="/api/contracts.html" class="sidebar-link">L1合约接口</a></li><li><section class="sidebar-group depth-0"><a href="/api/js" class="sidebar-heading clickable"><span>JavaScript SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/js/getting-started.html" class="sidebar-link">zkSync 功能</a></li><li><a href="/api/js/providers.html" class="sidebar-link">Providers</a></li><li><a href="/api/js/accounts.html" class="sidebar-link">账户: 概述</a></li><li><a href="/api/js/accounts-l1-l2.html" class="sidebar-link">账户：L1-&gt;L2交易</a></li><li><a href="/api/js/contracts.html" class="sidebar-link">合约</a></li><li><a href="/api/js/features.html" class="sidebar-link">前端集成</a></li><li><a href="/api/js/utils.html" class="sidebar-link">实用程序</a></li><li><a href="/api/js/types.html" class="sidebar-link">类型</a></li><li><a href="/api/js/front-end.html" class="sidebar-link">前端集成</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/python/getting-started" class="sidebar-heading clickable open active"><span>Python SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/python/getting-started.html" aria-current="page" class="active sidebar-link">入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#入门" class="sidebar-link">入门</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#先决条件" class="sidebar-link">先决条件</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#运行-sdk-示例" class="sidebar-link">运行 SDK 示例</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#以太坊签名" class="sidebar-link">以太坊签名</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#存入资金" class="sidebar-link">存入资金</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#查看余额" class="sidebar-link">查看余额</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#转账" class="sidebar-link">转账</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#转账-erc20-代币" class="sidebar-link">转账（ERC20 代币）</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#提取资金" class="sidebar-link">提取资金</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#部署智能合约" class="sidebar-link">部署智能合约</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#使用-create2-部署智能合约" class="sidebar-link">使用 Create2 部署智能合约</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/java/getting-started" class="sidebar-heading clickable"><span>Java SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/java/getting-started.html" class="sidebar-link">入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/go/getting-started" class="sidebar-heading clickable"><span>GO SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/go/getting-started.html" class="sidebar-link">入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/hardhat" class="sidebar-heading clickable"><span>Hardhat</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/hardhat/getting-started.html" class="sidebar-link">入门</a></li><li><a href="/api/hardhat/plugins.html" class="sidebar-link">插件</a></li><li><a href="/api/hardhat/testing.html" class="sidebar-link">本地测试</a></li><li><a href="/api/hardhat/compiling-libraries.html" class="sidebar-link">不可内联库的编译</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/tools/block-explorer" class="sidebar-heading clickable"><span>区块浏览器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/tools/block-explorer/intro.html" class="sidebar-link">使用区块浏览器</a></li><li><a href="/api/tools/block-explorer/block-view.html" class="sidebar-link">浏览区块</a></li><li><a href="/api/tools/block-explorer/contract-verification.html" class="sidebar-link">合约验证</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="入门"><a href="#入门" class="header-anchor">#</a> 入门</h2> <p>在本指南中，我们将演示如何：</p> <ol><li>连接到 zkSync 网络。</li> <li>将来自以太坊的资产存入 zkSync。</li> <li>检查余额。</li> <li>转账和提取资金（原生代币和ERC20代币）。</li> <li>部署智能合约。</li> <li>使用 create2 部署智能合约。</li></ol> <h2 id="先决条件"><a href="#先决条件" class="header-anchor">#</a> 先决条件</h2> <p>本指南假定您熟悉 <a href="https://docs.python.org/3/" target="_blank" rel="noopener noreferrer">Python<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 编程语言。</p> <h1 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h1> <p>要使用 <code>pip install</code> 命令安装 SDK，请运行以下命令：</p> <div class="language-py extra-class"><pre class="language-py"><code>pip install zksync2
</code></pre></div><h2 id="运行-sdk-示例"><a href="#运行-sdk-示例" class="header-anchor">#</a> 运行 SDK 示例</h2> <p>要开始使用这个SDK，您只需要上传一个提供的配置。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder

URL_TO_ETH_NETWORK <span class="token operator">=</span> <span class="token string">&quot;GOERLI_HTTPS_RPC&quot;</span>
ZKSYNC_NETWORK_URL <span class="token operator">=</span> <span class="token string">&quot;https://zksync2-testnet.zksync.dev&quot;</span>

eth_web3 <span class="token operator">=</span> Web3<span class="token punctuation">(</span>Web3<span class="token punctuation">.</span>HTTPProvider<span class="token punctuation">(</span>URL_TO_ETH_NETWORK<span class="token punctuation">)</span><span class="token punctuation">)</span>
zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
</code></pre></div><h2 id="以太坊签名"><a href="#以太坊签名" class="header-anchor">#</a> 以太坊签名</h2> <p>::: 警告</p> <p>⚠️ 切勿将私钥提交到文件跟踪历史记录中，否则您的帐户可能会被盗用。</p> <p>:::</p> <p>以太坊签名者由来自“zkSync2.signer.eth_signer”的“PrivateKeyEthSigner”抽象类表示。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">import</span> os

PRIVATE_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;YOUR_PRIVATE_KEY&quot;</span><span class="token punctuation">)</span>

account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span>PRIVATE_KEY<span class="token punctuation">)</span>
signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>
</code></pre></div><h2 id="存入资金"><a href="#存入资金" class="header-anchor">#</a> 存入资金</h2> <p>此示例显示如何将资金存入地址。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> web3<span class="token punctuation">.</span>middleware <span class="token keyword">import</span> geth_poa_middleware
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>gas_provider <span class="token keyword">import</span> StaticGasProvider
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> Token
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>eth_provider <span class="token keyword">import</span> EthereumProvider


<span class="token keyword">def</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#geth_poa_middleware is used to connect to geth --dev.</span>
    eth_web3<span class="token punctuation">.</span>middleware_onion<span class="token punctuation">.</span>inject<span class="token punctuation">(</span>geth_poa_middleware<span class="token punctuation">,</span> layer<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">#calculate  gas fees</span>
    gas_provider <span class="token operator">=</span> StaticGasProvider<span class="token punctuation">(</span>Web3<span class="token punctuation">.</span>toWei<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;gwei&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">555000</span><span class="token punctuation">)</span>

    <span class="token comment">#Create the ethereum provider for interacting with ethereum node, initialize zkSync signer and deposit funds.</span>
    eth_provider <span class="token operator">=</span> EthereumProvider<span class="token punctuation">.</span>build_ethereum_provider<span class="token punctuation">(</span>zkSync<span class="token operator">=</span>zkSync_web3<span class="token punctuation">,</span>
                                                            eth<span class="token operator">=</span>eth_web3<span class="token punctuation">,</span>
                                                            account<span class="token operator">=</span>account<span class="token punctuation">,</span>
                                                            gas_provider<span class="token operator">=</span>gas_provider<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> eth_provider<span class="token punctuation">.</span>deposit<span class="token punctuation">(</span>Token<span class="token punctuation">.</span>create_eth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    eth_web3<span class="token punctuation">.</span>toWei<span class="token punctuation">(</span><span class="token string">&quot;YOUR_AMOUNT_OF_ETH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ether&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    account<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    <span class="token comment"># Show the output of the transaction details.</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    deposit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="查看余额"><a href="#查看余额" class="header-anchor">#</a> 查看余额</h2> <p>这个例子展示了如何在 zkSync 网络上查看你的余额。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> EthBlockParams


<span class="token keyword">def</span> <span class="token function">get_account_balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    zk_balance <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_balance<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> EthBlockParams<span class="token punctuation">.</span>LATEST<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;zkSync balance: </span><span class="token interpolation"><span class="token punctuation">{</span>zk_balance<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    get_account_balance<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="转账"><a href="#转账" class="header-anchor">#</a> 转账</h2> <p>这个例子展示了如何在 zkSync 网络上执行从一个账户到另一个账户的转账。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_function_call_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount

<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">transfer_to_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    tx <span class="token operator">=</span> create_function_call_transaction<span class="token punctuation">(</span>from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          to<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          data<span class="token operator">=</span>HexStr<span class="token punctuation">(</span><span class="token string">&quot;0x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>Web3<span class="token punctuation">.</span>toWei<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token string">'ether'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    transfer_to_self<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="转账-erc20-代币"><a href="#转账-erc20-代币" class="header-anchor">#</a> 转账（ERC20 代币）</h2> <p>这个例子展示了如何将 ERC20 代币转移到你在 zkSync 网络上的账户。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_function_call_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>erc20_contract <span class="token keyword">import</span> ERC20FunctionEncoder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">transfer_erc20_token</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    tokens <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>zks_get_confirmed_tokens<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    not_eth_tokens <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> tokens <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">.</span>is_eth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    token_address <span class="token operator">=</span> not_eth_tokens<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>l2_address

    erc20_encoder <span class="token operator">=</span> ERC20FunctionEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    transfer_params <span class="token operator">=</span> <span class="token punctuation">[</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    call_data <span class="token operator">=</span> erc20_encoder<span class="token punctuation">.</span>encode_method<span class="token punctuation">(</span><span class="token string">&quot;transfer&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span>transfer_params<span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create_function_call_transaction<span class="token punctuation">(</span>from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          to<span class="token operator">=</span>token_address<span class="token punctuation">,</span>
                                          ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          data<span class="token operator">=</span>call_data<span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    transfer_erc20_token<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="提取资金"><a href="#提取资金" class="header-anchor">#</a> 提取资金</h2> <p>此示例显示如何将资金提取到您的帐户中。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">from</span> decimal <span class="token keyword">import</span> Decimal
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_function_call_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>l2_bridge <span class="token keyword">import</span> L2BridgeEncoder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> Token<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">,</span> BridgeAddresses
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount

<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>
    ETH_TOKEN <span class="token operator">=</span> Token<span class="token punctuation">.</span>create_eth<span class="token punctuation">(</span><span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    bridges<span class="token punctuation">:</span> BridgeAddresses <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>zks_get_bridge_contracts<span class="token punctuation">(</span><span class="token punctuation">)</span>

    l2_func_encoder <span class="token operator">=</span> L2BridgeEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    call_data <span class="token operator">=</span> l2_func_encoder<span class="token punctuation">.</span>encode_function<span class="token punctuation">(</span>fn_name<span class="token operator">=</span><span class="token string">&quot;withdraw&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span>
        account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        ETH_TOKEN<span class="token punctuation">.</span>l2_address<span class="token punctuation">,</span>
        ETH_TOKEN<span class="token punctuation">.</span>to_int<span class="token punctuation">(</span>Decimal<span class="token punctuation">(</span><span class="token string">&quot;0.001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create_function_call_transaction<span class="token punctuation">(</span>from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          to<span class="token operator">=</span>bridges<span class="token punctuation">.</span>l2_eth_default_bridge<span class="token punctuation">,</span>
                                          ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          data<span class="token operator">=</span>HexStr<span class="token punctuation">(</span>call_data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    withdraw<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="部署智能合约"><a href="#部署智能合约" class="header-anchor">#</a> 部署智能合约</h2> <p>使用 zkSync，您可以使用 <code>create</code> 方法部署合约，只需将合约构建为二进制格式并将其部署到 zkSync 网络。</p> <p>在接下来的步骤中，我们将指导您了解它的工作原理。</p> <h3 id="第一步-创建合约"><a href="#第一步-创建合约" class="header-anchor">#</a> 第一步：创建合约</h3> <p>这是一个简单的合约：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.0</span><span class="token punctuation">;</span>

<span class="token keyword">contract</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token builtin">uint256</span> value<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> x<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        value <span class="token operator">+=</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">view</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>只能通过 zkSync 编译器编译！</p></blockquote> <p>编译后必须有2个文件：</p> <ul><li>contract binary representation</li> <li>contract ABI in JSON format</li></ul> <h3 id="步骤-2-部署合约"><a href="#步骤-2-部署合约" class="header-anchor">#</a> 步骤 2：部署合约</h3> <p>要部署合约，需要合约 ABI 以标准的 <code>web3</code> 方式调用其方法。</p> <p>在某些情况下，您需要在部署之前获取合约地址。</p> <p>这是您将如何做的一个例子。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> json
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> web3<span class="token punctuation">.</span>types <span class="token keyword">import</span> TxParams
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_contract_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>contract_deployer <span class="token keyword">import</span> ContractDeployer
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>nonce_holder <span class="token keyword">import</span> NonceHolder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams<span class="token punctuation">,</span> EthBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">read_binary</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> contact_file<span class="token punctuation">:</span>
        data <span class="token operator">=</span> contact_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data


<span class="token keyword">def</span> <span class="token function">get_abi</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_f<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">CounterContractEncoder</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> web3<span class="token punctuation">:</span> Web3<span class="token punctuation">,</span> bin_path<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> abi_path<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>web3 <span class="token operator">=</span> web3
        self<span class="token punctuation">.</span>counter_contract <span class="token operator">=</span> self<span class="token punctuation">.</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>contract<span class="token punctuation">(</span>abi<span class="token operator">=</span>get_abi<span class="token punctuation">(</span>abi_path<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                       bytecode<span class="token operator">=</span>read_binary<span class="token punctuation">(</span>bin_path<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encode_method</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn_name<span class="token punctuation">,</span> args<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> HexStr<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>counter_contract<span class="token punctuation">.</span>encodeABI<span class="token punctuation">(</span>fn_name<span class="token punctuation">,</span> args<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">deploy_contract_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    counter_contract_bin <span class="token operator">=</span> read_binary<span class="token punctuation">(</span><span class="token string">&quot;PATH_TO_BINARY_COMPILED_CONTRACT&quot;</span><span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> EthBlockParams<span class="token punctuation">.</span>PENDING<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    nonce_holder <span class="token operator">=</span> NonceHolder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">,</span> account<span class="token punctuation">)</span>
    deployment_nonce <span class="token operator">=</span> nonce_holder<span class="token punctuation">.</span>get_deployment_nonce<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    deployer <span class="token operator">=</span> ContractDeployer<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    precomputed_address <span class="token operator">=</span> deployer<span class="token punctuation">.</span>compute_l2_create_address<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> deployment_nonce<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;precomputed address: </span><span class="token interpolation"><span class="token punctuation">{</span>precomputed_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create_contract_transaction<span class="token punctuation">(</span>web3<span class="token operator">=</span>zkSync_web3<span class="token punctuation">,</span>
                                     from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                     ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                     ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                     bytecode<span class="token operator">=</span>counter_contract_bin<span class="token punctuation">)</span>

    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    contract_address <span class="token operator">=</span> tx_receipt<span class="token punctuation">[</span><span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;contract address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    counter_contract_encoder <span class="token operator">=</span> CounterContractEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">,</span> <span class="token string">&quot;PATH_TO_BINARY_COMPILED_CONTRACT&quot;</span><span class="token punctuation">,</span>
                                                      <span class="token string">&quot;PATH_TO_CONTRACT_ABI&quot;</span><span class="token punctuation">)</span>

    call_data <span class="token operator">=</span> counter_contract_encoder<span class="token punctuation">.</span>encode_method<span class="token punctuation">(</span>fn_name<span class="token operator">=</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    eth_tx<span class="token punctuation">:</span> TxParams <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;from&quot;</span><span class="token punctuation">:</span> account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        <span class="token string">&quot;to&quot;</span><span class="token punctuation">:</span> contract_address<span class="token punctuation">,</span>
        <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span> call_data
    <span class="token punctuation">}</span>
    <span class="token comment"># Value is type dependent so might need to be converted to corresponded type under Python</span>
    eth_ret <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>call<span class="token punctuation">(</span>eth_tx<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    converted_result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>eth_ret<span class="token punctuation">,</span> <span class="token string">&quot;big&quot;</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Call method for deployed contract, address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">, value: </span><span class="token interpolation"><span class="token punctuation">{</span>converted_result<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    deploy_contract_create<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="使用-create2-部署智能合约"><a href="#使用-create2-部署智能合约" class="header-anchor">#</a> 使用 Create2 部署智能合约</h2> <p>使用 <a href="https://eips.ethereum.org/EIPS/eip-1014" target="_blank" rel="noopener noreferrer">CREATE2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 操作码使您能够预测将部署合约的地址，而无需这样做，从而改善用户引导。</p> <p>与上面的 <code>create</code> 方法类似，这里是如何使用 zkSync 上的 <code>create2</code> 方法部署合约的实现。</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> web3<span class="token punctuation">.</span>types <span class="token keyword">import</span> TxParams
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create2_contract_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>contract_deployer <span class="token keyword">import</span> ContractDeployer
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams<span class="token punctuation">,</span> EthBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712

<span class="token comment">#Generate random salt(an arbitrary value provided by the sender)</span>
<span class="token keyword">def</span> <span class="token function">generate_random_salt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token comment">#Open the file</span>
<span class="token keyword">def</span> <span class="token function">read_binary</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> contact_file<span class="token punctuation">:</span>
        data <span class="token operator">=</span> contact_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data

<span class="token comment">#Get the contract ABI</span>
<span class="token keyword">def</span> <span class="token function">get_abi</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_f<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">CounterContractEncoder</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> web3<span class="token punctuation">:</span> Web3<span class="token punctuation">,</span> bin_path<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> abi_path<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>web3 <span class="token operator">=</span> web3
        self<span class="token punctuation">.</span>counter_contract <span class="token operator">=</span> self<span class="token punctuation">.</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>contract<span class="token punctuation">(</span>abi<span class="token operator">=</span>get_abi<span class="token punctuation">(</span>abi_path<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                       bytecode<span class="token operator">=</span>read_binary<span class="token punctuation">(</span>bin_path<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encode_method</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn_name<span class="token punctuation">,</span> args<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> HexStr<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>counter_contract<span class="token punctuation">.</span>encodeABI<span class="token punctuation">(</span>fn_name<span class="token punctuation">,</span> args<span class="token punctuation">)</span>

<span class="token comment">#Deploy the contract</span>
<span class="token keyword">def</span> <span class="token function">deploy_contract_create2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    counter_contract_bin <span class="token operator">=</span> read_binary<span class="token punctuation">(</span><span class="token string">&quot;PATH_TO_BINARY_COMPILED_CONTRACT&quot;</span><span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> EthBlockParams<span class="token punctuation">.</span>PENDING<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    deployer <span class="token operator">=</span> ContractDeployer<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    random_salt <span class="token operator">=</span> generate_random_salt<span class="token punctuation">(</span><span class="token punctuation">)</span>
    precomputed_address <span class="token operator">=</span> deployer<span class="token punctuation">.</span>compute_l2_create2_address<span class="token punctuation">(</span>sender<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                                              bytecode<span class="token operator">=</span>counter_contract_bin<span class="token punctuation">,</span>
                                                              constructor<span class="token operator">=</span><span class="token string">b''</span><span class="token punctuation">,</span>
                                                              salt<span class="token operator">=</span>random_salt<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;precomputed address: </span><span class="token interpolation"><span class="token punctuation">{</span>precomputed_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create2_contract_transaction<span class="token punctuation">(</span>web3<span class="token operator">=</span>zkSync_web3<span class="token punctuation">,</span>
                                      from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                      ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                      ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                      bytecode<span class="token operator">=</span>counter_contract_bin<span class="token punctuation">,</span>
                                      salt<span class="token operator">=</span>random_salt<span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    contract_address <span class="token operator">=</span> tx_receipt<span class="token punctuation">[</span><span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;contract address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    counter_contract_encoder <span class="token operator">=</span> CounterContractEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">,</span> <span class="token string">&quot;CONTRACT_BIN_PATH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CONTRACT_ABI_PATH&quot;</span><span class="token punctuation">)</span>
    call_data <span class="token operator">=</span> counter_contract_encoder<span class="token punctuation">.</span>encode_method<span class="token punctuation">(</span>fn_name<span class="token operator">=</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    eth_tx<span class="token punctuation">:</span> TxParams <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;from&quot;</span><span class="token punctuation">:</span> account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        <span class="token string">&quot;to&quot;</span><span class="token punctuation">:</span> contract_address<span class="token punctuation">,</span>
        <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span> call_data
    <span class="token punctuation">}</span>
    eth_ret <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>call<span class="token punctuation">(</span>eth_tx<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>eth_ret<span class="token punctuation">,</span> <span class="token string">&quot;big&quot;</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Call method for deployed contract, address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">, value: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    deploy_contract_create2<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>::: 注意</p> <p>⚠️ 这一部分文档仍在更新中，不久将会更新更详细的信息。</p> <p>:::</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/matter-labs/zksync-web-v2-docs/edit/main/docs/api/python/getting-started.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/22/2022, 9:59:25 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/api/js/front-end.html" class="prev">
        前端集成
      </a></span> <span class="next"><a href="/api/java/getting-started.html">
        入门
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3e63508a.js" defer></script><script src="/assets/js/2.5a73362d.js" defer></script><script src="/assets/js/39.9ac412c7.js" defer></script>
  </body>
</html>
