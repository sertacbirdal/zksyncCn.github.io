<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting started | zkSync — Accelerating the mass adoption of crypto for personal sovereignty</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="/__/firebase/7.13.2/firebase-app.js" defer="true"></script>
    <script src="/__/firebase/7.13.2/firebase-analytics.js" defer="true"></script>
    <script src="/__/firebase/init.js" defer="true"></script>
    <script>
  const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://zksync.io");
      homeEl.setAttribute("onclick", "document.location='https://zksync.io';return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://zksync.io';return false;");
      clearInterval(logoUrlChanger);
    }
  }, 1000)</script>
    <meta name="description" content="zkSync is a ZK rollup that represents the end-game for scaling Ethereum - one that scales its technology and values without degrading security or decentralization">
    
    <link rel="preload" href="/assets/css/0.styles.350a0b01.css" as="style"><link rel="preload" href="/assets/js/app.43917907.js" as="script"><link rel="preload" href="/assets/js/2.b99b9aa7.js" as="script"><link rel="preload" href="/assets/js/39.75916700.js" as="script"><link rel="prefetch" href="/assets/js/10.1d31b665.js"><link rel="prefetch" href="/assets/js/11.b268b3af.js"><link rel="prefetch" href="/assets/js/12.1f0cd004.js"><link rel="prefetch" href="/assets/js/13.e8e247c1.js"><link rel="prefetch" href="/assets/js/14.0c7cfd9a.js"><link rel="prefetch" href="/assets/js/15.94b050a9.js"><link rel="prefetch" href="/assets/js/16.e6a47b37.js"><link rel="prefetch" href="/assets/js/17.bd98224d.js"><link rel="prefetch" href="/assets/js/18.23b03e52.js"><link rel="prefetch" href="/assets/js/19.25249c92.js"><link rel="prefetch" href="/assets/js/20.2dded543.js"><link rel="prefetch" href="/assets/js/21.fb191a53.js"><link rel="prefetch" href="/assets/js/22.a420b171.js"><link rel="prefetch" href="/assets/js/23.5f0d4d48.js"><link rel="prefetch" href="/assets/js/24.818c5088.js"><link rel="prefetch" href="/assets/js/25.32e18cd1.js"><link rel="prefetch" href="/assets/js/26.60c607be.js"><link rel="prefetch" href="/assets/js/27.5f9274ea.js"><link rel="prefetch" href="/assets/js/28.96f99bb5.js"><link rel="prefetch" href="/assets/js/29.4de36988.js"><link rel="prefetch" href="/assets/js/3.ed255a8a.js"><link rel="prefetch" href="/assets/js/30.85d3bf0e.js"><link rel="prefetch" href="/assets/js/31.ed6d1d5e.js"><link rel="prefetch" href="/assets/js/32.87ab6f87.js"><link rel="prefetch" href="/assets/js/33.ce141b46.js"><link rel="prefetch" href="/assets/js/34.9f2d876f.js"><link rel="prefetch" href="/assets/js/35.29a9c1ad.js"><link rel="prefetch" href="/assets/js/36.2da22722.js"><link rel="prefetch" href="/assets/js/37.0682c26e.js"><link rel="prefetch" href="/assets/js/38.16d96427.js"><link rel="prefetch" href="/assets/js/4.b4b311da.js"><link rel="prefetch" href="/assets/js/40.9a130885.js"><link rel="prefetch" href="/assets/js/41.ce38f5e4.js"><link rel="prefetch" href="/assets/js/42.c7a15e4d.js"><link rel="prefetch" href="/assets/js/43.7834cbc1.js"><link rel="prefetch" href="/assets/js/44.6e1a6fcc.js"><link rel="prefetch" href="/assets/js/45.b2282fdb.js"><link rel="prefetch" href="/assets/js/46.c8b51949.js"><link rel="prefetch" href="/assets/js/47.2c07aaec.js"><link rel="prefetch" href="/assets/js/48.5a3734c4.js"><link rel="prefetch" href="/assets/js/49.c8407e2d.js"><link rel="prefetch" href="/assets/js/5.8c7caf1b.js"><link rel="prefetch" href="/assets/js/50.83537251.js"><link rel="prefetch" href="/assets/js/51.f2b013a0.js"><link rel="prefetch" href="/assets/js/52.1e097047.js"><link rel="prefetch" href="/assets/js/53.70102f1d.js"><link rel="prefetch" href="/assets/js/54.9d27e80f.js"><link rel="prefetch" href="/assets/js/55.e6743c5a.js"><link rel="prefetch" href="/assets/js/56.ea022ccd.js"><link rel="prefetch" href="/assets/js/57.940e83ac.js"><link rel="prefetch" href="/assets/js/58.35f73dba.js"><link rel="prefetch" href="/assets/js/59.8ad42a80.js"><link rel="prefetch" href="/assets/js/6.7c0612a4.js"><link rel="prefetch" href="/assets/js/60.77f33987.js"><link rel="prefetch" href="/assets/js/61.5f78a27b.js"><link rel="prefetch" href="/assets/js/62.2de7f05e.js"><link rel="prefetch" href="/assets/js/63.e44719a8.js"><link rel="prefetch" href="/assets/js/64.251ed610.js"><link rel="prefetch" href="/assets/js/65.3d4a291b.js"><link rel="prefetch" href="/assets/js/66.87c9e577.js"><link rel="prefetch" href="/assets/js/67.3c815a55.js"><link rel="prefetch" href="/assets/js/68.88efe7ab.js"><link rel="prefetch" href="/assets/js/69.8275e1f5.js"><link rel="prefetch" href="/assets/js/7.9cb55bb9.js"><link rel="prefetch" href="/assets/js/70.d449182f.js"><link rel="prefetch" href="/assets/js/71.db493a22.js"><link rel="prefetch" href="/assets/js/72.237d5480.js"><link rel="prefetch" href="/assets/js/73.367496ca.js"><link rel="prefetch" href="/assets/js/74.32c417d0.js"><link rel="prefetch" href="/assets/js/75.cff6aa61.js"><link rel="prefetch" href="/assets/js/76.b6732dd4.js"><link rel="prefetch" href="/assets/js/8.f9eaafb5.js"><link rel="prefetch" href="/assets/js/9.2e9fb4a6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.350a0b01.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/LogotypeLight.svg" alt="zkSync — Accelerating the mass adoption of crypto for personal sovereignty" class="logo"> <span class="site-name can-hide">zkSync — Accelerating the mass adoption of crypto for personal sovereignty</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dev/" class="nav-link">
  开发文档
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  工具/SDK
</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="v2.0" class="dropdown-title"><span class="title">v2.0</span> <span class="arrow down"></span></button> <button type="button" aria-label="v2.0" class="mobile-dropdown-title"><span class="title">v2.0</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link">
  v2.0
</a></li><li class="dropdown-item"><!----> <a href="https://docs.zksync.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/matter-labs/zksync-web-v2-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dev/" class="nav-link">
  开发文档
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  工具/SDK
</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="v2.0" class="dropdown-title"><span class="title">v2.0</span> <span class="arrow down"></span></button> <button type="button" aria-label="v2.0" class="mobile-dropdown-title"><span class="title">v2.0</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link">
  v2.0
</a></li><li class="dropdown-item"><!----> <a href="https://docs.zksync.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/matter-labs/zksync-web-v2-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/api/" aria-current="page" class="sidebar-link">概述</a></li><li><a href="/api/api.html" class="sidebar-link">Web3 API</a></li><li><a href="/api/contracts.html" class="sidebar-link">L1合约借口</a></li><li><section class="sidebar-group depth-0"><a href="/api/js" class="sidebar-heading clickable"><span>JavaScript SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/js/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/api/js/providers.html" class="sidebar-link">Providers</a></li><li><a href="/api/js/accounts.html" class="sidebar-link">Accounts: overview</a></li><li><a href="/api/js/accounts-l1-l2.html" class="sidebar-link">Accounts: L1-&gt;L2 transactions</a></li><li><a href="/api/js/contracts.html" class="sidebar-link">Contracts</a></li><li><a href="/api/js/features.html" class="sidebar-link">zkSync features</a></li><li><a href="/api/js/utils.html" class="sidebar-link">Utilities</a></li><li><a href="/api/js/types.html" class="sidebar-link">Types</a></li><li><a href="/api/js/front-end.html" class="sidebar-link">Front-end integration</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/python/getting-started" class="sidebar-heading clickable open active"><span>Python SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/python/getting-started.html" aria-current="page" class="active sidebar-link">Getting started</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#prerequisite" class="sidebar-link">Prerequisite</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#instantiating-the-sdk" class="sidebar-link">Instantiating the SDK</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#ethereum-signer" class="sidebar-link">Ethereum signer</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#depositing-funds" class="sidebar-link">Depositing funds</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#checking-balance" class="sidebar-link">Checking balance</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#performing-a-transfer" class="sidebar-link">Performing a transfer</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#transfer-funds-erc20-tokens" class="sidebar-link">Transfer funds (ERC20 tokens)</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#withdrawing-funds" class="sidebar-link">Withdrawing funds</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#deploy-a-smart-contract" class="sidebar-link">Deploy a smart contract</a></li><li class="sidebar-sub-header"><a href="/api/python/getting-started.html#deploy-a-smart-contract-with-create2" class="sidebar-link">Deploy a smart contract with Create2</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/java/getting-started" class="sidebar-heading clickable"><span>Java SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/java/getting-started.html" class="sidebar-link">Getting started</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/go/getting-started" class="sidebar-heading clickable"><span>GO SDK</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/go/getting-started.html" class="sidebar-link">Getting started</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/hardhat" class="sidebar-heading clickable"><span>Hardhat</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/hardhat/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/api/hardhat/plugins.html" class="sidebar-link">Plugins</a></li><li><a href="/api/hardhat/testing.html" class="sidebar-link">Local testing</a></li><li><a href="/api/hardhat/compiling-libraries.html" class="sidebar-link">Compiling non-inlinable libraries</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/api/tools/block-explorer" class="sidebar-heading clickable"><span>区块浏览器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/tools/block-explorer/intro.html" class="sidebar-link">Using the Block Explorer</a></li><li><a href="/api/tools/block-explorer/block-view.html" class="sidebar-link">Browse blocks</a></li><li><a href="/api/tools/block-explorer/contract-verification.html" class="sidebar-link">智能合约验证</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting started</h1> <p>In this guide we will demonstrate how to:</p> <ol><li>Connect to the zkSync network.</li> <li>Deposit assets from Ethereum into zkSync.</li> <li>Check balances.</li> <li>Transfer and withdraw funds (native and ERC20 tokens).</li> <li>Deploy a smart contract.</li> <li>Deploy a smart contract with create2.</li></ol> <h2 id="prerequisite"><a href="#prerequisite" class="header-anchor">#</a> Prerequisite</h2> <p>This guide assumes that you are familiar with <a href="https://docs.python.org/3/" target="_blank" rel="noopener noreferrer">Python<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> programming language.</p> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>To install the SDK with the <code>pip install</code> command, run the following:</p> <div class="language-py extra-class"><pre class="language-py"><code>
pip install zksync2

</code></pre></div><h2 id="instantiating-the-sdk"><a href="#instantiating-the-sdk" class="header-anchor">#</a> Instantiating the SDK</h2> <p>To start using this SDK, you just need to pass in a provider configuration.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder

URL_TO_ETH_NETWORK <span class="token operator">=</span> <span class="token string">&quot;GOERLI_HTTPS_RPC&quot;</span>
ZKSYNC_NETWORK_URL <span class="token operator">=</span> <span class="token string">&quot;https://zksync2-testnet.zksync.dev&quot;</span>

eth_web3 <span class="token operator">=</span> Web3<span class="token punctuation">(</span>Web3<span class="token punctuation">.</span>HTTPProvider<span class="token punctuation">(</span>URL_TO_ETH_NETWORK<span class="token punctuation">)</span><span class="token punctuation">)</span>
zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>

</code></pre></div><h2 id="ethereum-signer"><a href="#ethereum-signer" class="header-anchor">#</a> Ethereum signer</h2> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>⚠️ Never commit private keys to file tracking history, or your account could be compromised.</p></div> <p>Ethereum signer is represented by the <code>PrivateKeyEthSigner</code> abstract class from <code>zkSync2.signer.eth_signer</code>.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">import</span> os

PRIVATE_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;YOUR_PRIVATE_KEY&quot;</span><span class="token punctuation">)</span>

account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span>PRIVATE_KEY<span class="token punctuation">)</span>
signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

</code></pre></div><h2 id="depositing-funds"><a href="#depositing-funds" class="header-anchor">#</a> Depositing funds</h2> <p>This example shows how to deposit funds into an address.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> web3<span class="token punctuation">.</span>middleware <span class="token keyword">import</span> geth_poa_middleware
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>gas_provider <span class="token keyword">import</span> StaticGasProvider
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> Token
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>eth_provider <span class="token keyword">import</span> EthereumProvider


<span class="token keyword">def</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#geth_poa_middleware is used to connect to geth --dev.</span>
    eth_web3<span class="token punctuation">.</span>middleware_onion<span class="token punctuation">.</span>inject<span class="token punctuation">(</span>geth_poa_middleware<span class="token punctuation">,</span> layer<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">#calculate  gas fees</span>
    gas_provider <span class="token operator">=</span> StaticGasProvider<span class="token punctuation">(</span>Web3<span class="token punctuation">.</span>toWei<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;gwei&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">555000</span><span class="token punctuation">)</span>

    <span class="token comment">#Create the ethereum provider for interacting with ethereum node, initialize zkSync signer and deposit funds.</span>
    eth_provider <span class="token operator">=</span> EthereumProvider<span class="token punctuation">.</span>build_ethereum_provider<span class="token punctuation">(</span>zkSync<span class="token operator">=</span>zkSync_web3<span class="token punctuation">,</span>
                                                            eth<span class="token operator">=</span>eth_web3<span class="token punctuation">,</span>
                                                            account<span class="token operator">=</span>account<span class="token punctuation">,</span>
                                                            gas_provider<span class="token operator">=</span>gas_provider<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> eth_provider<span class="token punctuation">.</span>deposit<span class="token punctuation">(</span>Token<span class="token punctuation">.</span>create_eth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    eth_web3<span class="token punctuation">.</span>toWei<span class="token punctuation">(</span><span class="token string">&quot;YOUR_AMOUNT_OF_ETH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ether&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    account<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    <span class="token comment"># Show the output of the transaction details.</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    deposit<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="checking-balance"><a href="#checking-balance" class="header-anchor">#</a> Checking balance</h2> <p>This example shows how to check your balance on the zkSync network.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> EthBlockParams


<span class="token keyword">def</span> <span class="token function">get_account_balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    zk_balance <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_balance<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> EthBlockParams<span class="token punctuation">.</span>LATEST<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;zkSync balance: </span><span class="token interpolation"><span class="token punctuation">{</span>zk_balance<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    get_account_balance<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="performing-a-transfer"><a href="#performing-a-transfer" class="header-anchor">#</a> Performing a transfer</h2> <p>This example shows how to execute a transfer from one account to another, on the zkSync network.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_function_call_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount

<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">transfer_to_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    tx <span class="token operator">=</span> create_function_call_transaction<span class="token punctuation">(</span>from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          to<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          data<span class="token operator">=</span>HexStr<span class="token punctuation">(</span><span class="token string">&quot;0x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>Web3<span class="token punctuation">.</span>toWei<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token string">'ether'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    transfer_to_self<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre></div><h2 id="transfer-funds-erc20-tokens"><a href="#transfer-funds-erc20-tokens" class="header-anchor">#</a> Transfer funds (ERC20 tokens)</h2> <p>This example shows how to transfer ERC20 tokens into your account on the zkSync network.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_function_call_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>erc20_contract <span class="token keyword">import</span> ERC20FunctionEncoder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">transfer_erc20_token</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    tokens <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>zks_get_confirmed_tokens<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    not_eth_tokens <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> tokens <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">.</span>is_eth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    token_address <span class="token operator">=</span> not_eth_tokens<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>l2_address

    erc20_encoder <span class="token operator">=</span> ERC20FunctionEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    transfer_params <span class="token operator">=</span> <span class="token punctuation">[</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    call_data <span class="token operator">=</span> erc20_encoder<span class="token punctuation">.</span>encode_method<span class="token punctuation">(</span><span class="token string">&quot;transfer&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span>transfer_params<span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create_function_call_transaction<span class="token punctuation">(</span>from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          to<span class="token operator">=</span>token_address<span class="token punctuation">,</span>
                                          ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          data<span class="token operator">=</span>call_data<span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    transfer_erc20_token<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre></div><h2 id="withdrawing-funds"><a href="#withdrawing-funds" class="header-anchor">#</a> Withdrawing funds</h2> <p>This examples shows how to withdraw funds into your account.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">from</span> decimal <span class="token keyword">import</span> Decimal
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_function_call_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>l2_bridge <span class="token keyword">import</span> L2BridgeEncoder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> Token<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">,</span> BridgeAddresses
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount

<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>
    ETH_TOKEN <span class="token operator">=</span> Token<span class="token punctuation">.</span>create_eth<span class="token punctuation">(</span><span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    bridges<span class="token punctuation">:</span> BridgeAddresses <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>zks_get_bridge_contracts<span class="token punctuation">(</span><span class="token punctuation">)</span>

    l2_func_encoder <span class="token operator">=</span> L2BridgeEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    call_data <span class="token operator">=</span> l2_func_encoder<span class="token punctuation">.</span>encode_function<span class="token punctuation">(</span>fn_name<span class="token operator">=</span><span class="token string">&quot;withdraw&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span>
        account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        ETH_TOKEN<span class="token punctuation">.</span>l2_address<span class="token punctuation">,</span>
        ETH_TOKEN<span class="token punctuation">.</span>to_int<span class="token punctuation">(</span>Decimal<span class="token punctuation">(</span><span class="token string">&quot;0.001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create_function_call_transaction<span class="token punctuation">(</span>from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                          to<span class="token operator">=</span>bridges<span class="token punctuation">.</span>l2_eth_default_bridge<span class="token punctuation">,</span>
                                          ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                          data<span class="token operator">=</span>HexStr<span class="token punctuation">(</span>call_data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    withdraw<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre></div><h2 id="deploy-a-smart-contract"><a href="#deploy-a-smart-contract" class="header-anchor">#</a> Deploy a smart contract</h2> <p>With zkSync, you can deploy a contract using the <code>create</code> method, by simply building the contract into a binary format and deploying it to the zkSync network.</p> <p>In the next steps, we will guide you through how it works.</p> <h3 id="step1-create-a-contract"><a href="#step1-create-a-contract" class="header-anchor">#</a> Step1: Create a contract</h3> <p>Here is a simple contract:</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code>
<span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.0</span><span class="token punctuation">;</span>

<span class="token keyword">contract</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token builtin">uint256</span> value<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> x<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        value <span class="token operator">+=</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">view</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p>It must be compiled by zkSync compiler only!</p></blockquote> <p>After compilation there must be 2 files with the:</p> <ul><li>contract binary representation</li> <li>contract ABI in JSON format</li></ul> <h3 id="step-2-deploy-the-contract"><a href="#step-2-deploy-the-contract" class="header-anchor">#</a> Step 2: Deploy the contract</h3> <p>To deploy the contract, contract ABI is needed for calling its methods in the standard <code>web3</code> way.</p> <p>In some cases, you would need to get the contract address before deploying it.</p> <p>Here's an example of how you would do it.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> web3<span class="token punctuation">.</span>types <span class="token keyword">import</span> TxParams
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create_contract_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>contract_deployer <span class="token keyword">import</span> ContractDeployer
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>nonce_holder <span class="token keyword">import</span> NonceHolder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams<span class="token punctuation">,</span> EthBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712


<span class="token keyword">def</span> <span class="token function">read_binary</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> contact_file<span class="token punctuation">:</span>
        data <span class="token operator">=</span> contact_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data


<span class="token keyword">def</span> <span class="token function">get_abi</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_f<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">CounterContractEncoder</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> web3<span class="token punctuation">:</span> Web3<span class="token punctuation">,</span> bin_path<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> abi_path<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>web3 <span class="token operator">=</span> web3
        self<span class="token punctuation">.</span>counter_contract <span class="token operator">=</span> self<span class="token punctuation">.</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>contract<span class="token punctuation">(</span>abi<span class="token operator">=</span>get_abi<span class="token punctuation">(</span>abi_path<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                       bytecode<span class="token operator">=</span>read_binary<span class="token punctuation">(</span>bin_path<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encode_method</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn_name<span class="token punctuation">,</span> args<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> HexStr<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>counter_contract<span class="token punctuation">.</span>encodeABI<span class="token punctuation">(</span>fn_name<span class="token punctuation">,</span> args<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">deploy_contract_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    counter_contract_bin <span class="token operator">=</span> read_binary<span class="token punctuation">(</span><span class="token string">&quot;PATH_TO_BINARY_COMPILED_CONTRACT&quot;</span><span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> EthBlockParams<span class="token punctuation">.</span>PENDING<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    nonce_holder <span class="token operator">=</span> NonceHolder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">,</span> account<span class="token punctuation">)</span>
    deployment_nonce <span class="token operator">=</span> nonce_holder<span class="token punctuation">.</span>get_deployment_nonce<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    deployer <span class="token operator">=</span> ContractDeployer<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    precomputed_address <span class="token operator">=</span> deployer<span class="token punctuation">.</span>compute_l2_create_address<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> deployment_nonce<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;precomputed address: </span><span class="token interpolation"><span class="token punctuation">{</span>precomputed_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create_contract_transaction<span class="token punctuation">(</span>web3<span class="token operator">=</span>zkSync_web3<span class="token punctuation">,</span>
                                     from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                     ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                     ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                     bytecode<span class="token operator">=</span>counter_contract_bin<span class="token punctuation">)</span>

    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    contract_address <span class="token operator">=</span> tx_receipt<span class="token punctuation">[</span><span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;contract address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    counter_contract_encoder <span class="token operator">=</span> CounterContractEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">,</span> <span class="token string">&quot;PATH_TO_BINARY_COMPILED_CONTRACT&quot;</span><span class="token punctuation">,</span>
                                                      <span class="token string">&quot;PATH_TO_CONTRACT_ABI&quot;</span><span class="token punctuation">)</span>

    call_data <span class="token operator">=</span> counter_contract_encoder<span class="token punctuation">.</span>encode_method<span class="token punctuation">(</span>fn_name<span class="token operator">=</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    eth_tx<span class="token punctuation">:</span> TxParams <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;from&quot;</span><span class="token punctuation">:</span> account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        <span class="token string">&quot;to&quot;</span><span class="token punctuation">:</span> contract_address<span class="token punctuation">,</span>
        <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span> call_data
    <span class="token punctuation">}</span>
    <span class="token comment"># Value is type dependent so might need to be converted to corresponded type under Python</span>
    eth_ret <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>call<span class="token punctuation">(</span>eth_tx<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    converted_result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>eth_ret<span class="token punctuation">,</span> <span class="token string">&quot;big&quot;</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Call method for deployed contract, address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">, value: </span><span class="token interpolation"><span class="token punctuation">{</span>converted_result<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    deploy_contract_create<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="deploy-a-smart-contract-with-create2"><a href="#deploy-a-smart-contract-with-create2" class="header-anchor">#</a> Deploy a smart contract with Create2</h2> <p>Using the <a href="https://eips.ethereum.org/EIPS/eip-1014" target="_blank" rel="noopener noreferrer">CREATE2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> opcode gives you the ability to predict the address where a contract will be deployed, without ever having to do so, hence improving user onboarding.</p> <p>Similar to the <code>create</code> method above, here's the implementation on how you can deploy a contract using the <code>create2</code> method on zkSync.</p> <div class="language-py extra-class"><pre class="language-py"><code>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">from</span> eth_typing <span class="token keyword">import</span> HexStr
<span class="token keyword">from</span> web3 <span class="token keyword">import</span> Web3
<span class="token keyword">from</span> web3<span class="token punctuation">.</span>types <span class="token keyword">import</span> TxParams
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>request_types <span class="token keyword">import</span> create2_contract_transaction
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>manage_contracts<span class="token punctuation">.</span>contract_deployer <span class="token keyword">import</span> ContractDeployer
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>module<span class="token punctuation">.</span>module_builder <span class="token keyword">import</span> zkSyncBuilder
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>types <span class="token keyword">import</span> ZkBlockParams<span class="token punctuation">,</span> EthBlockParams
<span class="token keyword">from</span> eth_account <span class="token keyword">import</span> Account
<span class="token keyword">from</span> eth_account<span class="token punctuation">.</span>signers<span class="token punctuation">.</span>local <span class="token keyword">import</span> LocalAccount
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>signer<span class="token punctuation">.</span>eth_signer <span class="token keyword">import</span> PrivateKeyEthSigner
<span class="token keyword">from</span> zkSync2<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>transaction712 <span class="token keyword">import</span> Transaction712

<span class="token comment">#Generate random salt(an arbitrary value provided by the sender)</span>
<span class="token keyword">def</span> <span class="token function">generate_random_salt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token comment">#Open the file</span>
<span class="token keyword">def</span> <span class="token function">read_binary</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> contact_file<span class="token punctuation">:</span>
        data <span class="token operator">=</span> contact_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data

<span class="token comment">#Get the contract ABI</span>
<span class="token keyword">def</span> <span class="token function">get_abi</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> p<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_f<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">CounterContractEncoder</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> web3<span class="token punctuation">:</span> Web3<span class="token punctuation">,</span> bin_path<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> abi_path<span class="token punctuation">:</span> Path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>web3 <span class="token operator">=</span> web3
        self<span class="token punctuation">.</span>counter_contract <span class="token operator">=</span> self<span class="token punctuation">.</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>contract<span class="token punctuation">(</span>abi<span class="token operator">=</span>get_abi<span class="token punctuation">(</span>abi_path<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                       bytecode<span class="token operator">=</span>read_binary<span class="token punctuation">(</span>bin_path<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encode_method</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn_name<span class="token punctuation">,</span> args<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> HexStr<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>counter_contract<span class="token punctuation">.</span>encodeABI<span class="token punctuation">(</span>fn_name<span class="token punctuation">,</span> args<span class="token punctuation">)</span>

<span class="token comment">#Deploy the contract</span>
<span class="token keyword">def</span> <span class="token function">deploy_contract_create2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ZKSYNC_NETWORK_URL<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'https://zkSync2-testnet.zkSync.dev'</span>
    account<span class="token punctuation">:</span> LocalAccount <span class="token operator">=</span> Account<span class="token punctuation">.</span>from_key<span class="token punctuation">(</span><span class="token string">'YOUR_PRIVATE_KEY'</span><span class="token punctuation">)</span>
    zkSync_web3 <span class="token operator">=</span> zkSyncBuilder<span class="token punctuation">.</span>build<span class="token punctuation">(</span>ZKSYNC_NETWORK_URL<span class="token punctuation">)</span>
    chain_id <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>chain_id
    signer <span class="token operator">=</span> PrivateKeyEthSigner<span class="token punctuation">(</span>account<span class="token punctuation">,</span> chain_id<span class="token punctuation">)</span>

    counter_contract_bin <span class="token operator">=</span> read_binary<span class="token punctuation">(</span><span class="token string">&quot;PATH_TO_BINARY_COMPILED_CONTRACT&quot;</span><span class="token punctuation">)</span>

    nonce <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span> EthBlockParams<span class="token punctuation">.</span>PENDING<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    deployer <span class="token operator">=</span> ContractDeployer<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">)</span>
    random_salt <span class="token operator">=</span> generate_random_salt<span class="token punctuation">(</span><span class="token punctuation">)</span>
    precomputed_address <span class="token operator">=</span> deployer<span class="token punctuation">.</span>compute_l2_create2_address<span class="token punctuation">(</span>sender<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                                              bytecode<span class="token operator">=</span>counter_contract_bin<span class="token punctuation">,</span>
                                                              constructor<span class="token operator">=</span><span class="token string">b''</span><span class="token punctuation">,</span>
                                                              salt<span class="token operator">=</span>random_salt<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;precomputed address: </span><span class="token interpolation"><span class="token punctuation">{</span>precomputed_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx <span class="token operator">=</span> create2_contract_transaction<span class="token punctuation">(</span>web3<span class="token operator">=</span>zkSync_web3<span class="token punctuation">,</span>
                                      from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                                      ergs_price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                      ergs_limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                      bytecode<span class="token operator">=</span>counter_contract_bin<span class="token punctuation">,</span>
                                      salt<span class="token operator">=</span>random_salt<span class="token punctuation">)</span>
    estimate_gas <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>eth_estimate_gas<span class="token punctuation">(</span>tx<span class="token punctuation">)</span>
    gas_price <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>gas_price
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Fee for transaction is: </span><span class="token interpolation"><span class="token punctuation">{</span>estimate_gas <span class="token operator">*</span> gas_price<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    tx_712 <span class="token operator">=</span> Transaction712<span class="token punctuation">(</span>chain_id<span class="token operator">=</span>chain_id<span class="token punctuation">,</span>
                            nonce<span class="token operator">=</span>nonce<span class="token punctuation">,</span>
                            gas_limit<span class="token operator">=</span>estimate_gas<span class="token punctuation">,</span>
                            to<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;to&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            value<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            data<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            maxPriorityFeePerGas<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">,</span>
                            maxFeePerGas<span class="token operator">=</span>gas_price<span class="token punctuation">,</span>
                            from_<span class="token operator">=</span>account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
                            meta<span class="token operator">=</span>tx<span class="token punctuation">[</span><span class="token string">&quot;eip712Meta&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    singed_message <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign_typed_data<span class="token punctuation">(</span>tx_712<span class="token punctuation">.</span>to_eip712_struct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg <span class="token operator">=</span> tx_712<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>singed_message<span class="token punctuation">)</span>
    tx_hash <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    tx_receipt <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">,</span> poll_latency<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;tx status: </span><span class="token interpolation"><span class="token punctuation">{</span>tx_receipt<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    contract_address <span class="token operator">=</span> tx_receipt<span class="token punctuation">[</span><span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;contract address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    counter_contract_encoder <span class="token operator">=</span> CounterContractEncoder<span class="token punctuation">(</span>zkSync_web3<span class="token punctuation">,</span> <span class="token string">&quot;CONTRACT_BIN_PATH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CONTRACT_ABI_PATH&quot;</span><span class="token punctuation">)</span>
    call_data <span class="token operator">=</span> counter_contract_encoder<span class="token punctuation">.</span>encode_method<span class="token punctuation">(</span>fn_name<span class="token operator">=</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    eth_tx<span class="token punctuation">:</span> TxParams <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;from&quot;</span><span class="token punctuation">:</span> account<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        <span class="token string">&quot;to&quot;</span><span class="token punctuation">:</span> contract_address<span class="token punctuation">,</span>
        <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span> call_data
    <span class="token punctuation">}</span>
    eth_ret <span class="token operator">=</span> zkSync_web3<span class="token punctuation">.</span>zkSync<span class="token punctuation">.</span>call<span class="token punctuation">(</span>eth_tx<span class="token punctuation">,</span> ZkBlockParams<span class="token punctuation">.</span>COMMITTED<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>eth_ret<span class="token punctuation">,</span> <span class="token string">&quot;big&quot;</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Call method for deployed contract, address: </span><span class="token interpolation"><span class="token punctuation">{</span>contract_address<span class="token punctuation">}</span></span><span class="token string">, value: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    deploy_contract_create2<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>⚠️ This section of the docs is still in progress and will be updated with more detailed information soon.</p></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/matter-labs/zksync-web-v2-docs/edit/main/docs/api/python/getting-started.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/31/2022, 10:58:48 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/api/js/front-end.html" class="prev">
        Front-end integration
      </a></span> <span class="next"><a href="/api/java/getting-started.html">
        Getting started
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.43917907.js" defer></script><script src="/assets/js/2.b99b9aa7.js" defer></script><script src="/assets/js/39.75916700.js" defer></script>
  </body>
</html>
