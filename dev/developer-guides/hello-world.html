<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quickstart | zkSync — Accelerating the mass adoption of crypto for personal sovereignty</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="/__/firebase/7.13.2/firebase-app.js" defer="true"></script>
    <script src="/__/firebase/7.13.2/firebase-analytics.js" defer="true"></script>
    <script src="/__/firebase/init.js" defer="true"></script>
    <script>
  const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://zksync.io");
      homeEl.setAttribute("onclick", "document.location='https://zksync.io';return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://zksync.io';return false;");
      clearInterval(logoUrlChanger);
    }
  }, 1000)</script>
    <meta name="description" content="zkSync is a ZK rollup that represents the end-game for scaling Ethereum - one that scales its technology and values without degrading security or decentralization">
    
    <link rel="preload" href="/assets/css/0.styles.350a0b01.css" as="style"><link rel="preload" href="/assets/js/app.c05cfcc8.js" as="script"><link rel="preload" href="/assets/js/2.5a73362d.js" as="script"><link rel="preload" href="/assets/js/3.073d186a.js" as="script"><link rel="prefetch" href="/assets/js/10.1d31b665.js"><link rel="prefetch" href="/assets/js/11.1babd81e.js"><link rel="prefetch" href="/assets/js/12.6a0fb8cc.js"><link rel="prefetch" href="/assets/js/13.fee8f0c2.js"><link rel="prefetch" href="/assets/js/14.0c7cfd9a.js"><link rel="prefetch" href="/assets/js/15.a0dce9fd.js"><link rel="prefetch" href="/assets/js/16.194f569d.js"><link rel="prefetch" href="/assets/js/17.5519ba2b.js"><link rel="prefetch" href="/assets/js/18.60014d7f.js"><link rel="prefetch" href="/assets/js/19.fdcd15af.js"><link rel="prefetch" href="/assets/js/20.29c80189.js"><link rel="prefetch" href="/assets/js/21.cbfdc048.js"><link rel="prefetch" href="/assets/js/22.a47ff286.js"><link rel="prefetch" href="/assets/js/23.d7ed71bc.js"><link rel="prefetch" href="/assets/js/24.81c68be0.js"><link rel="prefetch" href="/assets/js/25.afe0dc2b.js"><link rel="prefetch" href="/assets/js/26.0abc39fe.js"><link rel="prefetch" href="/assets/js/27.c3936ac3.js"><link rel="prefetch" href="/assets/js/28.e95190d8.js"><link rel="prefetch" href="/assets/js/29.61f46d4c.js"><link rel="prefetch" href="/assets/js/30.4f0c89bb.js"><link rel="prefetch" href="/assets/js/31.e218f05f.js"><link rel="prefetch" href="/assets/js/32.cc8aa65b.js"><link rel="prefetch" href="/assets/js/33.e257bee1.js"><link rel="prefetch" href="/assets/js/34.54d63fbb.js"><link rel="prefetch" href="/assets/js/35.c69d2ca4.js"><link rel="prefetch" href="/assets/js/36.d86e7687.js"><link rel="prefetch" href="/assets/js/37.236b4615.js"><link rel="prefetch" href="/assets/js/38.0c8a016e.js"><link rel="prefetch" href="/assets/js/39.2b1ae14e.js"><link rel="prefetch" href="/assets/js/4.405af041.js"><link rel="prefetch" href="/assets/js/40.22803ea2.js"><link rel="prefetch" href="/assets/js/41.729c9834.js"><link rel="prefetch" href="/assets/js/42.4d37c627.js"><link rel="prefetch" href="/assets/js/43.8463b35b.js"><link rel="prefetch" href="/assets/js/44.e605a149.js"><link rel="prefetch" href="/assets/js/45.f5cc65a1.js"><link rel="prefetch" href="/assets/js/46.040c3b33.js"><link rel="prefetch" href="/assets/js/47.1742c2e6.js"><link rel="prefetch" href="/assets/js/48.0a8fd426.js"><link rel="prefetch" href="/assets/js/49.1f4068ca.js"><link rel="prefetch" href="/assets/js/5.7bae62cf.js"><link rel="prefetch" href="/assets/js/50.c38bb825.js"><link rel="prefetch" href="/assets/js/51.9bfc556b.js"><link rel="prefetch" href="/assets/js/52.5a41b52d.js"><link rel="prefetch" href="/assets/js/53.b3c9e0f7.js"><link rel="prefetch" href="/assets/js/54.f5e00505.js"><link rel="prefetch" href="/assets/js/55.531d5c7a.js"><link rel="prefetch" href="/assets/js/56.fe219180.js"><link rel="prefetch" href="/assets/js/57.4e54910c.js"><link rel="prefetch" href="/assets/js/58.c7f14b85.js"><link rel="prefetch" href="/assets/js/59.bfe610be.js"><link rel="prefetch" href="/assets/js/6.a5466f63.js"><link rel="prefetch" href="/assets/js/60.7a2131e7.js"><link rel="prefetch" href="/assets/js/61.ed3ce206.js"><link rel="prefetch" href="/assets/js/62.2de7f05e.js"><link rel="prefetch" href="/assets/js/63.bb5f1763.js"><link rel="prefetch" href="/assets/js/64.ebd6db8c.js"><link rel="prefetch" href="/assets/js/65.c3e962c7.js"><link rel="prefetch" href="/assets/js/66.95aa148c.js"><link rel="prefetch" href="/assets/js/67.307f17c1.js"><link rel="prefetch" href="/assets/js/68.025e563f.js"><link rel="prefetch" href="/assets/js/69.d0b067fb.js"><link rel="prefetch" href="/assets/js/7.9cb55bb9.js"><link rel="prefetch" href="/assets/js/70.3fa22b2f.js"><link rel="prefetch" href="/assets/js/71.2b32dd42.js"><link rel="prefetch" href="/assets/js/72.6d871cf8.js"><link rel="prefetch" href="/assets/js/73.c6b3bb28.js"><link rel="prefetch" href="/assets/js/74.5d63dfe9.js"><link rel="prefetch" href="/assets/js/75.c07a7760.js"><link rel="prefetch" href="/assets/js/76.685eb63e.js"><link rel="prefetch" href="/assets/js/8.f9eaafb5.js"><link rel="prefetch" href="/assets/js/9.2e9fb4a6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.350a0b01.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/LogotypeLight.svg" alt="zkSync — Accelerating the mass adoption of crypto for personal sovereignty" class="logo"> <span class="site-name can-hide">zkSync — Accelerating the mass adoption of crypto for personal sovereignty</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  开发文档
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  工具/SDK
</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="v2.0" class="dropdown-title"><span class="title">v2.0</span> <span class="arrow down"></span></button> <button type="button" aria-label="v2.0" class="mobile-dropdown-title"><span class="title">v2.0</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link router-link-active">
  v2.0
</a></li><li class="dropdown-item"><!----> <a href="https://docs.zksync.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/matter-labs/zksync-web-v2-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  开发文档
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  工具/SDK
</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="v2.0" class="dropdown-title"><span class="title">v2.0</span> <span class="arrow down"></span></button> <button type="button" aria-label="v2.0" class="mobile-dropdown-title"><span class="title">v2.0</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link router-link-active">
  v2.0
</a></li><li class="dropdown-item"><!----> <a href="https://docs.zksync.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/matter-labs/zksync-web-v2-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/dev/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group depth-0"><a href="/dev/fundamentals" class="sidebar-heading clickable"><span>开始</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/fundamentals/rollups.html" class="sidebar-link">rollups 介绍</a></li><li><a href="/dev/fundamentals/zkSync.html" class="sidebar-link">zkSync 基础知识</a></li><li><a href="/dev/fundamentals/testnet.html" class="sidebar-link">zkSync 测试网</a></li><li><a href="/dev/fundamentals/faq.html" class="sidebar-link">FAQ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/dev/developer-guides" class="sidebar-heading clickable router-link-active"><span>关于zkSync</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/developer-guides/transactions/transactions.html" class="sidebar-link">交易</a></li><li><a href="/dev/developer-guides/transactions/blocks.html" class="sidebar-link">区块</a></li><li><a href="/dev/developer-guides/contracts/system-contracts.html" class="sidebar-link">系统合约</a></li><li><a href="/dev/developer-guides/aa.html" class="sidebar-link">账户抽象支持</a></li><li><a href="/dev/developer-guides/security.html" class="sidebar-link">安全模型</a></li><li><a href="/dev/developer-guides/transactions/fee-model.html" class="sidebar-link">费用机制</a></li><li><a href="/dev/developer-guides/bridging/bridging-asset.html" class="sidebar-link">桥接资产</a></li><li><a href="/dev/developer-guides/bridging/l1-l2-interop.html" class="sidebar-link">L1 / L2 的互操作性</a></li><li><a href="/dev/developer-guides/bridging/l1-l2.html" class="sidebar-link">L1 -&gt; L2 通信</a></li><li><a href="/dev/developer-guides/bridging/l2-l1.html" class="sidebar-link">L2 -&gt; L1 通信</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/dev/developer-guides/building-on-zksync" class="sidebar-heading clickable open"><span>在zkSync上构建</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/developer-guides/hello-world.html" aria-current="page" class="active sidebar-link">Quickstart</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/developer-guides/hello-world.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/dev/developer-guides/hello-world.html#initializing-the-project-deploying-a-smart-contract" class="sidebar-link">Initializing the project &amp; deploying a smart contract</a></li><li class="sidebar-sub-header"><a href="/dev/developer-guides/hello-world.html#front-end-integration" class="sidebar-link">Front-end integration</a></li></ul></li><li><a href="/dev/developer-guides/contracts/contracts.html" class="sidebar-link">合约部署</a></li><li><a href="/dev/developer-guides/contracts/contract-verification.html" class="sidebar-link">验证智能合约</a></li><li><a href="/dev/developer-guides/building-on-zksync/events.html" class="sidebar-link">处理事件</a></li><li><a href="/dev/developer-guides/building-on-zksync/rpc.html" class="sidebar-link">JSON-RPC API</a></li><li><a href="/dev/developer-guides/building-on-zksync/videos.html" class="sidebar-link">视频资源</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/dev/tutorials" class="sidebar-heading clickable"><span>教程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/tutorials/cross-chain-tutorial.html" class="sidebar-link">跨链治理</a></li><li><a href="/dev/tutorials/custom-aa-tutorial.html" class="sidebar-link">账户抽象</a></li><li><a href="/dev/tutorials/custom-paymaster-tutorial.html" class="sidebar-link">建立自定义 paymaster</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/dev/troubleshooting" class="sidebar-heading clickable"><span>错误排除</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/troubleshooting/important-links.html" class="sidebar-link">Important links</a></li><li><a href="/dev/troubleshooting/status.html" class="sidebar-link">Feature support status</a></li><li><a href="/dev/troubleshooting/docs-contribution/docs.html" class="sidebar-link">文档贡献指南</a></li><li><a href="/dev/troubleshooting/docs-contribution/community-resources.html" class="sidebar-link">Community resources</a></li><li><a href="/dev/troubleshooting/known-issues.html" class="sidebar-link">Known issues</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="quickstart"><a href="#quickstart" class="header-anchor">#</a> Quickstart</h1> <p>In this quickstart guide, you will learn how to deploy a smart contract to zkSync and build a dApp to interact with it using the zkSync development toolbox.</p> <p>This is what we're going to build:</p> <ul><li>A smart contract that stores a greeting message and is deployed on zkSync.</li> <li>A dApp to retrieve the greeting.</li> <li>Users will be able to change the greeting on the smart contract.</li> <li>By default, users will have to pay transaction fees to change the greeting message in ether. However, we will also explain how to <a href="#paying-fees-using-testnet-paymaster">implement the testnet paymaster</a> to allow users to pay fees with ERC20 tokens.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The testnet paymaster is just for testing. If you decide to build a project on mainnet, you should read the documentation about <a href="/dev/developer-guides/aa.html#paymasters">paymasters</a>.</p></div> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <ul><li><code>yarn</code> package manager. <a href="https://yarnpkg.com/getting-started/install" target="_blank" rel="noopener noreferrer">Here is the installation guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>(<code>npm</code> examples will be added soon.)</li> <li>A wallet with sufficient Göerli <code>ETH</code> on L1 to pay for bridging funds to zkSync as well as deploying smart contracts. ERC20 tokens on zkSync are required if you want to implement the testnet paymaster. We recommend using <a href="https://portal.zksync.io/faucet" target="_blank" rel="noopener noreferrer">the faucet from the zkSync portal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <h2 id="initializing-the-project-deploying-a-smart-contract"><a href="#initializing-the-project-deploying-a-smart-contract" class="header-anchor">#</a> Initializing the project &amp; deploying a smart contract</h2> <ol><li>Initialize the project and install the dependencies. Run the following commands in your terminal:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>mkdir greeter-example
cd greeter-example
yarn init -y
yarn add -D typescript ts-node ethers zksync-web3 hardhat @matterlabs/hardhat-zksync-solc @matterlabs/hardhat-zksync-deploy
</code></pre></div><p>Please note that Typescript is required by zkSync plugins.</p> <ol start="2"><li>Create the <code>hardhat.config.ts</code> file and paste the following code there:</li></ol> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;@matterlabs/hardhat-zksync-deploy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;@matterlabs/hardhat-zksync-solc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  zksolc<span class="token operator">:</span> <span class="token punctuation">{</span>
    version<span class="token operator">:</span> <span class="token string">&quot;1.2.0&quot;</span><span class="token punctuation">,</span>
    compilerSource<span class="token operator">:</span> <span class="token string">&quot;binary&quot;</span><span class="token punctuation">,</span>
    settings<span class="token operator">:</span> <span class="token punctuation">{</span>
      experimental<span class="token operator">:</span> <span class="token punctuation">{</span>
        dockerImage<span class="token operator">:</span> <span class="token string">&quot;matterlabs/zksolc&quot;</span><span class="token punctuation">,</span>
        tag<span class="token operator">:</span> <span class="token string">&quot;v1.2.0&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  zkSyncDeploy<span class="token operator">:</span> <span class="token punctuation">{</span>
    zkSyncNetwork<span class="token operator">:</span> <span class="token string">&quot;https://zksync2-testnet.zksync.dev&quot;</span><span class="token punctuation">,</span>
    ethNetwork<span class="token operator">:</span> <span class="token string">&quot;goerli&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Can also be the RPC URL of the network (e.g. `https://goerli.infura.io/v3/&lt;API_KEY&gt;`)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  networks<span class="token operator">:</span> <span class="token punctuation">{</span>
    hardhat<span class="token operator">:</span> <span class="token punctuation">{</span>
      zksync<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  solidity<span class="token operator">:</span> <span class="token punctuation">{</span>
    version<span class="token operator">:</span> <span class="token string">&quot;0.8.16&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Tip</p> <p>If the contract was already compiled, you should delete the <code>artifacts-zk</code> and <code>cache-zk</code> folders, otherwise, it won't recompile unless you change the compiler version.</p></div> <ol><li><p>Create the <code>contracts</code> and <code>deploy</code> folders. The former is the place where we will store all the smart contracts' <code>*.sol</code> files, and the latter is the place where we will put all the scripts related to deploying the contracts.</p></li> <li><p>Create the <code>contracts/Greeter.sol</code> contract and paste the following code in it:</p></li></ol> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">//SPDX-License-Identifier: Unlicense</span>
<span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.0</span><span class="token punctuation">;</span>

<span class="token keyword">contract</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
    <span class="token builtin">string</span> <span class="token keyword">private</span> greeting<span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _greeting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        greeting <span class="token operator">=</span> _greeting<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">view</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> greeting<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">setGreeting</span><span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _greeting<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        greeting <span class="token operator">=</span> _greeting<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>Compile the contract with the following command:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>yarn hardhat compile
</code></pre></div><ol start="6"><li>Create the following deployment script in <code>deploy/deploy.ts</code>:</li></ol> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Wallet<span class="token punctuation">,</span> Provider<span class="token punctuation">,</span> utils <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zksync-web3&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ethers <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> HardhatRuntimeEnvironment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;hardhat/types&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Deployer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@matterlabs/hardhat-zksync-deploy&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// An example of a deploy script that will deploy and call a simple contract.</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>hre<span class="token operator">:</span> HardhatRuntimeEnvironment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Running deploy script for the Greeter contract</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Initialize the wallet.</span>
  <span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Provider</span><span class="token punctuation">(</span>hre<span class="token punctuation">.</span>userConfig<span class="token punctuation">.</span>zkSyncDeploy<span class="token operator">?.</span>zkSyncNetwork<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Wallet</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;WALLET-PRIVATE-KEY&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Create deployer object and load the artifact of the contract you want to deploy.</span>
  <span class="token keyword">const</span> deployer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Deployer</span><span class="token punctuation">(</span>hre<span class="token punctuation">,</span> wallet<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> artifact <span class="token operator">=</span> <span class="token keyword">await</span> deployer<span class="token punctuation">.</span><span class="token function">loadArtifact</span><span class="token punctuation">(</span><span class="token string">&quot;Greeter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Estimate contract deployment fee</span>
  <span class="token keyword">const</span> greeting <span class="token operator">=</span> <span class="token string">&quot;Hi there!&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> deploymentFee <span class="token operator">=</span> <span class="token keyword">await</span> deployer<span class="token punctuation">.</span><span class="token function">estimateDeployFee</span><span class="token punctuation">(</span>artifact<span class="token punctuation">,</span> <span class="token punctuation">[</span>greeting<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Deposit funds to L2</span>
  <span class="token keyword">const</span> depositHandle <span class="token operator">=</span> <span class="token keyword">await</span> deployer<span class="token punctuation">.</span>zkWallet<span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    to<span class="token operator">:</span> deployer<span class="token punctuation">.</span>zkWallet<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
    token<span class="token operator">:</span> utils<span class="token punctuation">.</span><span class="token constant">ETH_ADDRESS</span><span class="token punctuation">,</span>
    amount<span class="token operator">:</span> deploymentFee<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Wait until the deposit is processed on zkSync</span>
  <span class="token keyword">await</span> depositHandle<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Deploy this contract. The returned object will be of a `Contract` type, similarly to ones in `ethers`.</span>
  <span class="token comment">// `greeting` is an argument for contract constructor.</span>
  <span class="token keyword">const</span> parsedFee <span class="token operator">=</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">formatEther</span><span class="token punctuation">(</span>deploymentFee<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The deployment is estimated to cost </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>parsedFee<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ETH</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> greeterContract <span class="token operator">=</span> <span class="token keyword">await</span> deployer<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>artifact<span class="token punctuation">,</span> <span class="token punctuation">[</span>greeting<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//obtain the Constructor Arguments</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;constructor args:&quot;</span> <span class="token operator">+</span> greeterContract<span class="token punctuation">.</span>interface<span class="token punctuation">.</span><span class="token function">encodeDeploy</span><span class="token punctuation">(</span><span class="token punctuation">[</span>greeting<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Show the contract info.</span>
  <span class="token keyword">const</span> contractAddress <span class="token operator">=</span> greeterContract<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>artifact<span class="token punctuation">.</span>contractName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> was deployed to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>contractAddress<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="7"><li>Replacing the <code>WALLET-PRIVATE-KEY</code> with the <code>0x</code>-prefixed private key of the Ethereum wallet you're using for development, and run the script using the following command to run the deployment script:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>yarn hardhat deploy-zksync
</code></pre></div><p>在 output 中，您将会看到部署智能合约的地址。</p> <p>Congratulations! You have deployed a smart contract to zkSync! Now you can visit the <a href="https://explorer.zksync.io/" target="_blank" rel="noopener noreferrer">zkSync block explorer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and search you contract address to confirm it was successfully deployed.</p> <p><a href="/api/tools/block-explorer/contract-verification.html">本指南</a>解释了如何使用 zkSync 区块浏览器验证您的智能合约。</p> <h2 id="front-end-integration"><a href="#front-end-integration" class="header-anchor">#</a> Front-end integration</h2> <h3 id="setting-up-the-project"><a href="#setting-up-the-project" class="header-anchor">#</a> Setting up the project</h3> <p>In this tutorial, <code>Vue</code> will be used as the web framework of choice, but the process will be quite similar regardless of the framework used. To focus on the specifics of using the <code>zksync-web3</code> SDK, we're providing a template with all the front-end work done. The final step is to interact with zkSync smart contract.</p> <ol><li>Clone it:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>git clone https://github.com/matter-labs/greeter-tutorial-starter
</code></pre></div><ol start="2"><li>Spin up the project:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>cd greeter-tutorial-starter
yarn
yarn serve
</code></pre></div><p>By default, the page should be running at <code>http://localhost:8080</code>. Open this URL in the browser to see the page.</p> <h3 id="connecting-to-metamask-bridging-tokens-to-zksync"><a href="#connecting-to-metamask-bridging-tokens-to-zksync" class="header-anchor">#</a> Connecting to Metamask &amp; bridging tokens to zkSync</h3> <p>In order to interact with dApps built on zkSync, connect the Metamask wallet to the zkSync alpha testnet network and bridge some funds to L2.</p> <ul><li><p>Follow <a href="/dev/fundamentals/testnet.html#connecting-metamask">this guide</a> to connect Metamask to zkSync.</p></li> <li><p>Use our <a href="https://portal.zksync.io" target="_blank" rel="noopener noreferrer">portal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to bridge funds to zkSync.</p></li></ul> <h3 id="project-structure"><a href="#project-structure" class="header-anchor">#</a> Project structure</h3> <p>We will write all the code in the <code>./src/App.vue</code>. Almost all the front-end code is provided out of the box, the only task left is to fill out the TODO-s to interact with the contract we just deployed on zkSync:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">initializeProviderAndSigner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: initialize provider and signer based on `window.ethereum`</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token keyword">async</span> <span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: return the current greeting</span>
  <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token keyword">async</span> <span class="token function">getFee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TOOD: return formatted fee</span>
  <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token keyword">async</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Return formatted balance</span>
  <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token keyword">async</span> <span class="token function">getOverrides</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>l1Address <span class="token operator">!=</span> <span class="token constant">ETH_L1_ADDRESS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: Return data for the paymaster</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token keyword">async</span> <span class="token function">changeGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: Submit the transaction</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">// TODO: Wait for transaction compilation</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token comment">// Update greeting</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingFee <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingBalance <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// Update balance and fee</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentBalance <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentFee <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingFee <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingBalance <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>At the top of the <code>&lt;script&gt;</code> tag, you may see the parts that should be filled with the address of the deployed <code>Greeter</code> contract and the path to its ABI. We will fill these fields in the following sections.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// eslint-disable-next-line</span>
<span class="token keyword">const</span> <span class="token constant">GREETER_CONTRACT_ADDRESS</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// TODO: insert the Greeter contract address here</span>
<span class="token comment">// eslint-disable-next-line</span>
<span class="token keyword">const</span> <span class="token constant">GREETER_CONTRACT_ABI</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// TODO: insert the path to the Greeter contract ABI here</span>
</code></pre></div><h3 id="installing-zksync-web3"><a href="#installing-zksync-web3" class="header-anchor">#</a> Installing <code>zksync-web3</code></h3> <p>Run the following command on the greeter-tutorial-starter root folder to install <code>zksync-web3</code> and <code>ethers</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>yarn add ethers zksync-web3
</code></pre></div><p>After that, import both libraries in the <code>script</code> part of the <code>App.vue</code> file (right before the contract constant). It should look like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zksync-web3&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// eslint-disable-next-line</span>
<span class="token keyword">const</span> <span class="token constant">GREETER_CONTRACT_ADDRESS</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// TODO: insert the Greeter contract address here</span>
<span class="token comment">// eslint-disable-next-line</span>
<span class="token keyword">const</span> <span class="token constant">GREETER_CONTRACT_ABI</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// TODO: insert the path to the Greeter contract ABI here</span>
</code></pre></div><h3 id="getting-the-abi-and-contract-address"><a href="#getting-the-abi-and-contract-address" class="header-anchor">#</a> Getting the ABI and contract address</h3> <p>Open <code>./src/App.vue</code> and set the <code>GREETER_CONTRACT_ADDRESS</code> constant equal to the address where the greeter contract was deployed.</p> <p>To interact with the smart contract we just deployed to zkSync, we also need its ABI. ABI stands for Application Binary Interface and, in short, it's a file that describes all available names and types of the smart contract methods to interact with it.</p> <ul><li>Create the <code>./src/abi.json</code> file.</li> <li>You can get the contract's ABI in the hardhat project folder from the previous section in the <code>./artifacts-zk/contracts/Greeter.sol/Greeter.json</code> file. You should copy the <code>abi</code> array and paste it into the <code>abi.json</code> file created in the previous step. The file should look roughly the following way:</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_greeting&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;constructor&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;greet&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;view&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_greeting&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;setGreeting&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>Set the <code>GREETER_CONTRACT_ABI</code> to require the ABI file.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// eslint-disable-next-line</span>
<span class="token keyword">const</span> <span class="token constant">GREETER_CONTRACT_ADDRESS</span> <span class="token operator">=</span> <span class="token string">&quot;0x...&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// eslint-disable-next-line</span>
<span class="token keyword">const</span> <span class="token constant">GREETER_CONTRACT_ABI</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./abi.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="working-with-provider"><a href="#working-with-provider" class="header-anchor">#</a> Working with provider</h3> <ol><li>Go to the <code>initializeProviderAndSigner</code> method in <code>./src/App.vue</code>. This method is called after the connection to Metamask is successful.</li></ol> <p>In this method we should:</p> <ul><li><p>Initialize a <code>Web3Provider</code> and a <code>Signer</code> to interact with zkSync.</p></li> <li><p>Initialize the <code>Contract</code> object to interact with the <code>Greeter</code> contract we just deployed.</p></li></ul> <ol start="2"><li>Import the necessary dependencies:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Contract<span class="token punctuation">,</span> Web3Provider<span class="token punctuation">,</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zksync-web3&quot;</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>Initialise the provider, signer, and contract instances like this:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">initializeProviderAndSigner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Provider</span><span class="token punctuation">(</span><span class="token string">'https://zksync2-testnet.zksync.dev'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Note that we still need to get the Metamask signer</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>signer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Web3Provider</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>ethereum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSigner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>contract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Contract</span><span class="token punctuation">(</span>
        <span class="token constant">GREETER_CONTRACT_ADDRESS</span><span class="token punctuation">,</span>
        <span class="token constant">GREETER_CONTRACT_ABI</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>signer
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="retrieving-the-greeting"><a href="#retrieving-the-greeting" class="header-anchor">#</a> Retrieving the greeting</h3> <ol><li>Fill in the method to retrieve the greeting from the smart contract:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Smart contract calls work the same way as in `ethers`</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The full methods now look the following way:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">initializeProviderAndSigner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Provider</span><span class="token punctuation">(</span><span class="token string">'https://zksync2-testnet.zksync.dev'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Note that we still need to get the Metamask signer</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>signer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Web3Provider</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>ethereum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSigner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>contract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Contract</span><span class="token punctuation">(</span>
        <span class="token constant">GREETER_CONTRACT_ADDRESS</span><span class="token punctuation">,</span>
        <span class="token constant">GREETER_CONTRACT_ABI</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>signer
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token keyword">async</span> <span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>连接 Metamask 钱包后，您应该会看到以下页面：</p> <p><img src="/assets/img/start-1.2212407f.png" alt="img"></p> <p>The chosen token to pay the fee can now be selected. However, no balances are updated, <em>yet</em>.</p> <h3 id="retrieving-token-balance-and-transaction-fee"><a href="#retrieving-token-balance-and-transaction-fee" class="header-anchor">#</a> Retrieving token balance and transaction fee</h3> <p>The easiest way to retrieve the user's balance is to use the <code>Signer.getBalance</code> method.</p> <ol><li>Add the necessary dependencies:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// `ethers` is only used in this tutorial for its utility functions</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ethers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>Implement the method itself:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Getting the balance for the signer in the selected token</span>
    <span class="token keyword">const</span> balanceInUnits <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>signer<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>l2Address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// To display the number of tokens in the human-readable format, we need to format them,</span>
    <span class="token comment">// e.g. if balanceInUnits returns 500000000000000000 wei of ETH, we want to display 0.5 ETH the user</span>
    <span class="token keyword">return</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">formatUnits</span><span class="token punctuation">(</span>balanceInUnits<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>decimals<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><ol start="3"><li>Estimate the fee:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getFee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Getting the amount of gas (ergs) needed for one transaction</span>
    <span class="token keyword">const</span> feeInGas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span>estimateGas<span class="token punctuation">.</span><span class="token function">setGreeting</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>newGreeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Getting the gas price per one erg. For now, it is the same for all tokens.</span>
    <span class="token keyword">const</span> gasPriceInUnits <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">getGasPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// To display the number of tokens in the human-readable format, we need to format them,</span>
    <span class="token comment">// e.g. if feeInGas*gasPriceInUnits returns 500000000000000000 wei of ETH, we want to display 0.5 ETH the user</span>
    <span class="token keyword">return</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">formatUnits</span><span class="token punctuation">(</span>feeInGas<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>gasPriceInUnits<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>decimals<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Paying fees in ERC20</p> <p>zkSync v2 does not natively support paying fees in ERC20 tokens, but the account abstraction feature facilitates that. We will show you how to implement the testnet paymaster below, however, when working on mainnet, you should either provide the paymaster services <a href="/dev/tutorials/custom-paymaster-tutorial.html">yourself</a> or use a
3rd party paymaster.</p></div> <p>When opening the page and selecting the token to pay the fee, the balance and the expected fee for the transaction will be available.</p> <p>The <code>Refresh</code> button should be used to recalculate the fee, as the fee may depend on the length of the message we want to store as the greeting.</p> <p>It is possible to also click on the <code>Change greeting</code> button, but nothing will be changed as the contract has not been called yet.</p> <p><img src="/assets/img/start-2.6e948cdc.png" alt="img"></p> <h3 id="updating-the-greeting"><a href="#updating-the-greeting" class="header-anchor">#</a> Updating the greeting</h3> <ol><li>Interacting with a smart contract works absolutely the same way as in <code>ethers</code>, however, if you want to use zkSync-specific features you may need to provide some additional parameters in the overrides:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// The example of paying fees using a paymaster will be shown in the</span>
<span class="token comment">// section below.</span>
<span class="token keyword">const</span> txHandle <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span><span class="token function">setGreeting</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>newGreeting<span class="token punctuation">,</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOverrides</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>Wait until the transaction is committed:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> txHandle<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The full method looks the following way:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">changeGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> txHandle <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span><span class="token function">setGreeting</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>newGreeting<span class="token punctuation">,</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOverrides</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

        <span class="token comment">// Wait until the transaction is committed</span>
        <span class="token keyword">await</span> txHandle<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

        <span class="token comment">// Update greeting</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingFee <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingBalance <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">// Update balance and fee</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentBalance <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentFee <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>txStatus <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingFee <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>retreivingBalance <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>You now have a fully functional Greeter-dApp! However, it does not leverage any zkSync-specific features.</p> <h3 id="paying-fees-using-testnet-paymaster"><a href="#paying-fees-using-testnet-paymaster" class="header-anchor">#</a> Paying fees using testnet paymaster</h3> <p>Even though ether is the only token you can pay fees with, the account abstraction feature allows you to integrate <a href="/dev/developer-guides/aa.html#paymasters">paymasters</a> that can either pay the fees entirely for you or swap your tokens on the fly. In this tutorial, we will use the <a href="/dev/developer-guides/aa.html#testnet-paymaster">testnet paymaster</a> that is provided on all zkSync testnets. It allows users to pay fees in an ERC20 token with the exchange rate of ETH of 1:1, i.e. one unit of the token for one wei of ETH.</p> <div class="custom-block tip"><p class="custom-block-title">Mainnet integration</p> <p>Testnet paymaster is purely for demonstration of the feature and won't be available on mainnet. When integrating your protocol on mainnet, you should follow the documentation of the paymaster you will use.</p></div> <p>当用户决定使用以太币支付时，<code>getOverrides</code> method 返回对象为“空”，但当用户选择ERC20选项时，它会返回 Paymaster 合约地址以及所需的全部信息。具体方法如下:</p> <ol><li>通过 zkSync Provider 中获取测试网 Paymaster 的合约地址：</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getOverrides</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>l1Address <span class="token operator">!=</span> <span class="token constant">ETH_L1_ADDRESS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> testnetPaymaster <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">getTestnetPaymasterAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ..</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note, that it is recommended to retrieve the testnet paymaster's address each time before any interactions as it may change.</p> <ol start="2"><li>Add <code>utils</code> to the imports from <code>zksync-web3</code> SDK:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Contract<span class="token punctuation">,</span> Web3Provider<span class="token punctuation">,</span> Provider<span class="token punctuation">,</span> utils <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zksync-web3&quot;</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>We need to calculate how many tokens are required to process the transaction. Since the testnet paymaster exchanges any ERC20 token to ETH at a 1:1 rate, the amount is the same as the ETH amount:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getOverrides</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>l1Address <span class="token operator">!=</span> <span class="token constant">ETH_L1_ADDRESS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> testnetPaymaster <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">getTestnetPaymasterAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> gasPrice <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">getGasPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> gasLimit <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span>estimateGas<span class="token punctuation">.</span><span class="token function">setGreeting</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>newGreeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fee <span class="token operator">=</span> gasPrice<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>gasLimit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ..</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>Now, what is left is to encode the paymasterInput following the <a href="/dev/developer-guides/aa.html#testnet-paymaster">protocol requirements</a> and return the needed overrides:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getOverrides</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>l1Address <span class="token operator">!=</span> <span class="token constant">ETH_L1_ADDRESS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> testnetPaymaster <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">getTestnetPaymasterAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> gasPrice <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">getGasPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> gasLimit <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contract<span class="token punctuation">.</span>estimateGas<span class="token punctuation">.</span><span class="token function">setGreeting</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>newGreeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fee <span class="token operator">=</span> gasPrice<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>gasLimit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> paymasterParams <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">getPaymasterParams</span><span class="token punctuation">(</span>testnetPaymaster<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'ApprovalBased'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">token</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectedToken<span class="token punctuation">.</span>l2Address<span class="token punctuation">,</span>
        <span class="token literal-property property">minimalAllowance</span><span class="token operator">:</span> fee<span class="token punctuation">,</span>
        <span class="token comment">// empty bytes as testnet paymaster does not use innerInput</span>
        <span class="token literal-property property">innerInput</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">maxFeePerGas</span><span class="token operator">:</span> gasPrice<span class="token punctuation">,</span>
        <span class="token literal-property property">maxPriorityFeePerGas</span><span class="token operator">:</span> ethers<span class="token punctuation">.</span>BigNumber<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        gasLimit<span class="token punctuation">,</span>
        <span class="token literal-property property">customData</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">ergsPerPubdata</span><span class="token operator">:</span> utils<span class="token punctuation">.</span><span class="token constant">DEFAULT_ERGS_PER_PUBDATA_LIMIT</span><span class="token punctuation">,</span>
            paymasterParams
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li>To use a list of ERC20 tokens, change the following line:</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> allowedTokens <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./eth.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>to the following one:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> allowedTokens <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./erc20.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="complete-app"><a href="#complete-app" class="header-anchor">#</a> Complete app</h3> <p>Now you should be able to update the greeting message.</p> <ol><li>Type the new greeting in the input box and click on the <code>Change greeting</code> button:</li></ol> <p><img src="/assets/img/start-3.5d73c63e.png" alt="img"></p> <ol><li>Since the <code>paymasterParams</code> were supplied, the transaction will be an <code>EIP712</code> (<a href="https://eips.ethereum.org/EIPS/eip-712" target="_blank" rel="noopener noreferrer">more on EIP712 here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>):</li></ol> <p><img src="/assets/img/start-4.cd0adb0a.png" alt="img"></p> <ol><li>Click &quot;Sign&quot;.</li></ol> <p>After the transaction is processed, the page updates the balances and the new greeting can be viewed:</p> <p><img src="/assets/img/start-5.496a1ab6.png" alt="img"></p> <h3 id="learn-more"><a href="#learn-more" class="header-anchor">#</a> Learn more</h3> <ul><li>To learn more about <code>zksync-web3</code> SDK, check out its <a href="../../api/js">documentation</a>.</li> <li>To learn more about the zkSync hardhat plugins, check out their <a href="../../api/hardhat">documentation</a>.</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/matter-labs/zksync-web-v2-docs/edit/main/docs/dev/developer-guides/hello-world.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/26/2022, 9:20:40 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dev/developer-guides/bridging/l2-l1.html" class="prev">
        L2 -&gt; L1 通信
      </a></span> <span class="next"><a href="/dev/developer-guides/contracts/contracts.html">
        合约部署
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c05cfcc8.js" defer></script><script src="/assets/js/2.5a73362d.js" defer></script><script src="/assets/js/3.073d186a.js" defer></script>
  </body>
</html>
